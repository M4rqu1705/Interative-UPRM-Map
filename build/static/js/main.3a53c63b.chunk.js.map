{"version":3,"sources":["components/Bubble.tsx","components/App.tsx","index.tsx"],"names":["Bubble","props","positionStyle","position","width","radius","height","left","top","zIndex","pointerEvents","animationStyle","style","active","className","animationDelay","App","defaultMessage","standardize","str","toLowerCase","normalize","replace","imageBoundingRect","useState","searchResult","setSearchResult","imageTop","setImageTop","imageLeft","setImageLeft","imageWidth","setImageWidth","imageHeight","setImageHeight","listExpanded","setListExpanded","updateImageProportions","document","getElementById","getBoundingClientRect","forEach","event","window","addEventListener","maxWidth","Field","Label","Control","Input","id","type","placeholder","onChange","preventDefault","query","currentTarget","value","length","foundKeyword","buildings","element","idx","keywords","includes","name","closestElement","closestScore","Number","MAX_SAFE_INTEGER","score","elementName","split","trim","a","b","d","i","temp","j","push","cost","Math","min","DamerauLeveshteinDistance","onKeyDown","keyCode","blur","transform","icon","faSearch","Content","map","endsWith","Image","padding","margin","src","alt","onClick","clickTop","clientY","clickLeft","clientX","pow","border","borderRadius","fullwidth","color","faChevronUp","faChevronDown","overflow","transition","maxHeight","marginTop","display","cursor","scroll","behavior","Footer","href","ReactDOM","render","StrictMode"],"mappings":"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","file":"static/js/main.3a53c63b.chunk.js","sourcesContent":["import React, { ReactElement } from \"react\";\nimport \"bulma/css/bulma.min.css\";\nimport \"../styles/Bubble.css\";\n\nexport default function Bubble(\n  props: BuildingsType & { active: boolean }\n): ReactElement {\n  const positionStyle: React.CSSProperties = {\n    position: \"fixed\",\n    width: props.radius * 2,\n    height: props.radius * 2,\n    left: props.left - props.radius,\n    top: props.top * 0.99 - props.radius,\n    zIndex: 1,\n    pointerEvents: \"none\",\n  };\n\n  const animationStyle: React.CSSProperties = {\n    height: props.radius * 2,\n    width: props.radius * 2,\n  };\n\n  return (\n    <div style={positionStyle}>\n      {props.active && (\n        <div\n          className=\"circle\"\n          style={{\n            animationDelay: \"0s\",\n            ...animationStyle,\n          }}\n        ></div>\n      )}\n      {props.active && (\n        <div\n          className=\"circle\"\n          style={{\n            animationDelay: \"0.25s\",\n            ...animationStyle,\n          }}\n        ></div>\n      )}\n    </div>\n  );\n}\n","import React, { useState, ReactElement } from \"react\";\nimport { Card, Content, Container, Form, Button } from \"react-bulma-components\";\nimport { FontAwesomeIcon } from \"@fortawesome/react-fontawesome\";\nimport {\n  faChevronDown,\n  faChevronUp,\n  faSearch,\n} from \"@fortawesome/free-solid-svg-icons\";\nimport Bubble from \"./Bubble\";\nimport buildings from \"../data/buildings.json\";\n\nfunction App(): ReactElement {\n  // Configuration constants\n  const defaultMessage =\n    \"Use la barra de búsqueda o haga click al lugar que quiera identificar.\";\n  const defaultErrorMessage = \"No se encontró ningún edificio con ese nombre.\";\n\n  // Helper function to put everything in lower-case and remove accents\n  function standardize(str: string) {\n    return str\n      .toLowerCase()\n      .normalize(\"NFD\")\n      .replace(/[\\u0300-\\u036f]/g, \"\");\n  }\n\n  // State variables\n  const [searchResult, setSearchResult] = useState(defaultMessage);\n\n  let imageBoundingRect: DOMRect | undefined;\n  const [imageTop, setImageTop] = useState(0);\n  const [imageLeft, setImageLeft] = useState(0);\n  const [imageWidth, setImageWidth] = useState(0);\n  const [imageHeight, setImageHeight] = useState(0);\n\n  const [listExpanded, setListExpanded] = useState(false);\n\n  // Event listeners\n  function updateImageProportions() {\n    imageBoundingRect = document\n      ?.getElementById(\"Mapa-UPRM\")\n      ?.getBoundingClientRect();\n\n    setImageTop(imageBoundingRect?.top || 0);\n    setImageLeft(imageBoundingRect?.left || 0);\n    setImageWidth(imageBoundingRect?.width || 0);\n    setImageHeight(imageBoundingRect?.height || 0);\n  }\n\n  // Add event listeners to update image size and position state\n  [\"load\", \"zoom\", \"orientationchange\", \"scroll\"].forEach((event: string) =>\n    window.addEventListener(event, updateImageProportions)\n  );\n\n  function imageWasClicked(event: React.MouseEvent<HTMLImageElement>) {\n    event.preventDefault();\n    updateImageProportions();\n\n    const clickTop = event.clientY;\n    const clickLeft = event.clientX;\n\n    buildings.forEach((element, idx: number) => {\n      if (\n        Math.pow(element.top - ((clickTop - imageTop) / imageHeight) * 100, 2) +\n          Math.pow(\n            element.left - ((clickLeft - imageLeft) / imageWidth) * 100,\n            2\n          ) <=\n        Math.pow(element.radius, 2)\n      ) {\n        if (element.name.endsWith(searchResult)) {\n          setSearchResult(defaultMessage);\n        } else {\n          setSearchResult(`(${idx + 1}) ${element.name}`);\n        }\n      }\n    });\n  }\n\n  function searchQueryChanged(event: React.ChangeEvent<HTMLInputElement>) {\n    event.preventDefault();\n    updateImageProportions();\n\n    function DamerauLeveshteinDistance(a: string, b: string): number {\n      const d: Array<Array<number>> = [];\n\n      for (let i = 0; i <= a.length; i++) {\n        const temp = [];\n        for (let j = 0; j <= b.length; j++) temp.push(0);\n        d.push(temp);\n      }\n\n      for (let i = 0; i <= a.length; i++) d[i][0] = i;\n      for (let j = 0; j <= b.length; j++) d[0][j] = j;\n\n      for (let i = 1; i <= a.length; i++) {\n        for (let j = 1; j <= b.length; j++) {\n          const cost = a[i - 1] === b[j - 1] ? 0 : 1;\n\n          d[i][j] = Math.min(\n            d[i - 1][j] + 1,\n            d[i][j - 1] + 1,\n            d[i - 1][j - 1] + cost\n          );\n\n          if (i > 2 && j > 2 && a[i - 1] === b[j - 2] && a[i - 2] === b[j - 1])\n            d[i][j] = Math.min(d[i][j], d[i - 2][j - 2] + 1);\n        }\n      }\n\n      return d[a.length][b.length];\n    }\n\n    const query = standardize(event.currentTarget.value);\n\n    if (query.length == 0) {\n      setSearchResult(defaultMessage);\n      return;\n    }\n\n    // First make the most to match keywords\n    let foundKeyword = false;\n    buildings.forEach((element, idx) => {\n      if (element.keywords.includes(query)) {\n        foundKeyword = true;\n        setSearchResult(`(${idx + 1}) ${element.name}`);\n        return;\n      }\n    });\n    if (foundKeyword) return;\n\n    // Otherwise find match with the smallest Damerau Leveshtein Distance\n    let closestElement = \"(0) \";\n    let closestScore = Number.MAX_SAFE_INTEGER;\n\n    buildings.forEach((element, idx) => {\n      let elementName = standardize(element.name);\n      let score = 0;\n\n      if (elementName.includes(\"(\") && elementName.split(\"(\")[1].length > 10)\n        elementName = elementName.split(\"(\")[0].trim();\n      score =\n        DamerauLeveshteinDistance(query, elementName) / elementName.length;\n\n      if (score < closestScore) {\n        closestElement = `(${idx + 1}) ${element.name}`;\n        closestScore = score;\n      }\n    });\n\n    if (closestElement.trim().length !== 0) setSearchResult(closestElement);\n    else setSearchResult(defaultErrorMessage);\n  }\n\n  return (\n    <Content>\n      <h1 className=\"my-5 is-size-1-desktop is-size-3-touch has-text-white has-text-centered\">\n        Mapa Interactivo UPRM\n      </h1>\n      <Card\n        className=\"py-4 px-5 mx-a\"\n        style={{ width: \"100vw\", maxWidth: \"1000px\" }}\n      >\n        <form>\n          <Form.Field>\n            <Form.Label className=\"is-size-4-touch is-size-2-desktop\">\n              Búsqueda\n            </Form.Label>\n            <Form.Control className=\"has-icons-left\">\n              <Form.Input\n                id=\"searchInput\"\n                type=\"search\"\n                placeholder=\"Stefani\"\n                className=\"is-size-5\"\n                onChange={searchQueryChanged}\n                onKeyDown={(event: React.KeyboardEvent<HTMLInputElement>) => {\n                  if (event.keyCode === 13) {\n                    event.preventDefault();\n                    event.currentTarget.blur();\n                  }\n                }}\n              />\n\n              <span className=\"icon is-large is-left\">\n                <FontAwesomeIcon\n                  transform=\"grow-12 down-6 right-6\"\n                  icon={faSearch}\n                />\n              </span>\n            </Form.Control>\n          </Form.Field>\n        </form>\n\n        <Card.Content className=\"p-0\">\n          {buildings.map((element: BuildingsType, idx: number) => (\n            <Bubble\n              key={idx}\n              name={element.name}\n              keywords={element.keywords}\n              top={(element.top / 100.0) * imageHeight + imageTop}\n              left={(element.left / 100.0) * imageWidth + imageLeft}\n              radius={(element.radius / 100.0) * imageWidth}\n              active={searchResult.endsWith(element.name)}\n            />\n          ))}\n\n          <Card.Image\n            id=\"Mapa-UPRM\"\n            style={{ padding: 0, margin: \"1rem\" }}\n            src=\"assets/Mapa_UPRM.webp\"\n            alt=\"Imagen del mapa de UPR Mayagüez\"\n            onClick={imageWasClicked}\n          />\n\n          <Container style={{ margin: \"1rem\" }}>\n            <p className=\"is-size-3-desktop is-size-5-touch\">{searchResult}</p>\n          </Container>\n\n          <Container\n            className=\"p-3 my-4\"\n            style={{\n              border: \"0.5rem double forestgreen\",\n              borderRadius: \"1rem\",\n              height: \"auto\",\n            }}\n          >\n            <Button\n              fullwidth={true}\n              color=\"success\"\n              onClick={() => setListExpanded(!listExpanded)}\n            >\n              {listExpanded ? (\n                <FontAwesomeIcon icon={faChevronUp} />\n              ) : (\n                <FontAwesomeIcon icon={faChevronDown} />\n              )}\n            </Button>\n\n            <div\n              style={{\n                overflow: \"hidden\",\n                transition: \"max-height 0.75s ease\",\n                height: \"auto\",\n                maxHeight: listExpanded ? \"5000px\" : \"0px\",\n                marginTop: listExpanded ? \"1rem\" : \"0\",\n              }}\n            >\n              {buildings.map((element: BuildingsType, idx: number) => (\n                <p\n                  key={idx}\n                  className=\"is-size-5 m-1\"\n                  style={{\n                    display: listExpanded ? \"block\" : \"none\",\n                    cursor: \"pointer\",\n                  }}\n                  onClick={(event: React.MouseEvent<HTMLParagraphElement>) => {\n                    event.preventDefault();\n                    setSearchResult(`(${idx + 1}) ${element.name}`);\n                    window.scroll({ top: 0, left: 0, behavior: \"smooth\" });\n                  }}\n                >\n                  {idx + 1}. {element.name}\n                </p>\n              ))}\n            </div>\n          </Container>\n        </Card.Content>\n\n        <Card.Footer className=\"is-flex is-flex-direction-column is-align-items-flex-start p-5\">\n          <h4>Enlaces útiles</h4>\n          <a className=\"is-size-5-desktop\" href=\"https://www.uprm.edu/portada/\">\n            Portada UPRM\n          </a>\n          <a\n            className=\"is-size-5-desktop\"\n            href=\"https://www.uprm.edu/portales/mapa/\"\n          >\n            Mapa oficial UPRM\n          </a>\n        </Card.Footer>\n      </Card>\n    </Content>\n  );\n}\n\nexport default App;\n\n// Thanks to https://www.kirupa.com/animations/creating_pulsing_circle_animation.htm\n// Thanks to https://en.wikipedia.org/wiki/Damerau%E2%80%93Levenshtein_distance\n","/* eslint-disable no-debugger, no-console */\nimport React from \"react\";\nimport ReactDOM from \"react-dom\";\nimport \"./styles/index.css\";\nimport \"bulma/css/bulma.min.css\";\nimport \"bulmaswatch/sandstone/bulmaswatch.min.css\";\nimport App from \"./components/App\";\n\nReactDOM.render(\n  <React.StrictMode>\n    <App />\n  </React.StrictMode>,\n  document.getElementById(\"root\")\n);\n"],"sourceRoot":""}